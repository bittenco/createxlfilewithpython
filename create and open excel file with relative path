# start my env
source myenv/bin/activate
# install openpyxl which is a Library to can create and open excel files with Python
pip install openpyxl
# open jupyter notebook:
jupyter notebook
# use the coding to open it with relative path:
import openpyxl

# Create a new Excel workbook
wb = openpyxl.Workbook()

# Create sheet names similar to the provided file
sheet_names = ['Instructions', 'Assumptions', 'Workings', 'Cash Flow', 'Sensitivity Analysis']

# Rename the default sheet and create additional ones
wb.active.title = sheet_names[0]
for name in sheet_names[1:]:
    wb.create_sheet(title=name)

# Adding instructions to the Instructions sheet
instructions_sheet = wb[sheet_names[0]]
instructions_sheet.append(["Instructions"])
instructions_sheet.append(["This financial model is for a renewable energy project in Kenya, focusing on a 100 MW solar farm."])
instructions_sheet.append(["Please refer to the Assumptions sheet for key input data and modify them as necessary."])
instructions_sheet.append(["The Workings sheet contains detailed calculations, while the Cash Flow and Sensitivity Analysis sheets summarize the financial outputs."])

# Adding assumptions to the Assumptions sheet
assumptions_sheet = wb[sheet_names[1]]
assumptions_sheet.append(["Assumptions", "", "Inputs - Economic & Funding"])
assumptions_sheet.append(["", "", "Start Date / Base Date for Costs (year ending)", "2023-03-31"])
assumptions_sheet.append(["", "", "Inflation Rate (RPI)", 0.025])
assumptions_sheet.append(["", "", "Debt Interest Rate", 0.06])
assumptions_sheet.append(["", "", "Debt Term (Years)", 10])
assumptions_sheet.append(["", "", "Equity Financing", 50000000])
assumptions_sheet.append(["", "", "Debt Financing", 70000000])
assumptions_sheet.append(["", "", "Discount Rate", 0.10])
assumptions_sheet.append(["", "", "Tax Rate", 0.30])

assumptions_sheet.append(["", "", "Inputs - Business"])
assumptions_sheet.append(["", "", "Project Capacity (MW)", 100])
assumptions_sheet.append(["", "", "Capacity Factor", 0.20])
assumptions_sheet.append(["", "", "Electricity Price ($/kWh)", 0.08])
assumptions_sheet.append(["", "", "Revenue Growth Rate", 0.005])
assumptions_sheet.append(["", "", "O&M Costs ($)", 2000000])
assumptions_sheet.append(["", "", "O&M Cost Growth Rate", 0.005])
assumptions_sheet.append(["", "", "Administrative Overheads ($)", 250000])
assumptions_sheet.append(["", "", "Depreciation Period (Years)", 20])
assumptions_sheet.append(["", "", "Terminal Value Growth Rate", 0.02])

# Save the file
output_path = output_path = 'Kenya_Energy_Project_Model_v4.xlsx'
wb.save(output_path)

output_path

# 1. Locate the File
#Since you used a relative path (output_path = 'Kenya_Energy_Project_Model_v4.xlsx'), the file will be saved in the directory where you executed the script. 
#If you are using a terminal or command line, this is typically the directory you were in when you ran the script.

#2. Open the File
#There are several ways to open the file:

#Directly via Excel:
#Navigate to the directory where the script is located.
#Find the Kenya_Energy_Project_Model_v4.xlsx file.
#Double-click the file, and it should open in Excel.


#Using Python (if you want to open it programmatically):
#You can use Python to open the file, though it will require additional libraries like os to automate opening Excel or viewing the file location.

#For Mac, you would use:

import subprocess

# Open the file directly on macOS
subprocess.run(['open', output_path])

#Via Jupyter Notebook:
#If you're running this in a Jupyter Notebook, you can also create a download link to access the file directly.

import IPython.display as display

# Create a download link in Jupyter Notebook
display.FileLink(output_path)

#3. Check the Directory in Jupyter Notebook
#If you're not sure where the file was saved, you can check your current working directory in Jupyter Notebook with:

import os
print(os.getcwd())

#This will print out the directory where your file was saved.

#---> but once I went to the directory and deleted it manually to test it. 
#the code still said some file was thre, so change to this:

import os
print(os.path.isfile('Kenya_Energy_Project_Model_v4.xlsx'))
# the answer it gave me was "false", so that was correct
